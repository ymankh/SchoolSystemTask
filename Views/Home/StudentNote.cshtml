@model List<StudentNote>

@{
    ViewBag.Title = "Students Notes";
    Layout = "_TeacherLayout";
}


<div class="container-fluid py-4">
    <h3 class="mb-4">Students Notes</h3>
    <div class="row mb-4">
        <div class="col-lg-8 col-md-6 mb-md-0 mb-4">
            <div class="card">
                <div class="card-header pb-0">
                    <div class="row">
                        <div class="col-lg-6 col-7">
                            <h6>Students Table</h6>
                            <p class="text-sm mb-0"></p>
                        </div>
                        <div class="col-lg-6 col-5 my-auto text-end"></div>
                    </div>
                </div>
                <!-- Table Section -->
                <div class="card-body px-0 pb-2">
                    <div class="table-responsive">
                        <table class="table align-items-center mb-0">
                            <thead>
                            <tr>
                                <th> Student Name </th>
                                <th> Note </th>
                                <th> Type </th>
                                <th> date </th>
                                <th> </th>
                            </tr>
                            </thead>
                            <tbody>
                            @if (!Model.Any())
                            {
                                <td colspan="5">There are no students notes yet.</td>
                            }
                            else
                            {
                                @foreach (var studentNote in Model)
                                {
                                    <tr>
                                        <td>
                                            <div class="d-flex px-2 py-1">
                                                <div>
                                                    <img src="/assets/new/profile-user.svg" class="avatar avatar-sm me-3"
                                                         alt="@studentNote.Student.FirstName @studentNote.Student.LastName"/>
                                                </div>
                                                <div class="d-flex flex-column justify-content-center">
                                                    <h6 class="mb-0 text-sm">
                                                        @studentNote.Student.FirstName
                                                        @studentNote.Student.LastName
                                                    </h6>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="text-xs font-weight-bold">@studentNote.Note</span>
                                        </td>

                                        <td>
                                            <span>@studentNote.NoteType.NoteTypeName</span>
                                        </td>
                                        <td>
                                            <span>@studentNote.DateTime.</span>
                                        </td>
                                        <td class="align-middle">
                                            <span class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top"
                                                  title="Edit note" data-container="body" data-animation="true">
                                                <a href="javascript:" class="btn btn-link edit-note-btn"
                                                   data-bs-toggle="modal" data-bs-target="#EditNoteModal"
                                                   onclick="editStudentNoteModel(@studentNote.Id)">
                                                    <i class="fa-solid fa-edit ms-1"></i>
                                                </a>
                                            </span>
                                            <span class="d-inline-block" data-bs-toggle="tooltip" data-bs-placement="top"
                                                  title="Delete Note" data-container="body" data-animation="true">
                                                <a href="javascript:" class="btn btn-link edit-note-btn"
                                                   data-bs-toggle="modal" data-bs-target="#EditNoteModal"
                                                   onclick="editStudentNoteModel(@studentNote.Id)">
                                                    <i class="fa-solid fa-trash ms-1"></i>
                                                </a>
                                            </span>
                                        </td>
                                    </tr>
                                }
                            }
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <partial name="_LatestUpdates"/>


    </div>
    <footer class="footer py-4">
        <div class="container-fluid">
            <div class="row align-items-center justify-content-lg-between">
                <div class="col-lg-4 mb-lg-0 mb-4">
                    <div class="copyright text-center text-sm text-muted text-lg-start">
                        ©
                        <script>
                            document.write(new Date().getFullYear());
                        </script>
                        , TaleamPro
                    </div>
                </div>
            </div>
        </div>
    </footer>
</div>

@section Modals {
    <!-- Student Note form -->
    <div class="modal fade" id="AddNoteModal" tabindex="-1" role="dialog" aria-labelledby="AddNoteModal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title font-weight-normal">
                        Add a student note
                    </h5>
                    <button type="button" class="btn-close text-dark" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post" action="@Url.Action("AddStudentNote", "Home")">
                        <div class="input-group input-group-outline my-3">
                            <select class="form-control" required name="noteTypeId">
                                <option disabled selected>Note Type</option>
                            </select>
                        </div>
                        <input type="text" class="d-none" name="studentId" id="addStudentNoteStudentId">
                        <div class="input-group input-group-outline my-3">
                            <textarea class="form-control" rows="4" name="note" placeholder="Enter the note details here..."
                                required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit Note</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- Add student form -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title font-weight-normal" id="exampleModalLabel">
                        Add Student Note
                    </h5>
                    <button type="button" class="btn-close text-dark" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="post">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="input-group input-group-outline my-3">
                                    <label class="form-label">Student Full Name</label>
                                    <input type="text" class="form-control" required name="FullName"/>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="input-group input-group-outline my-3">
                                    <label class="form-label">National ID</label>
                                    <input type="text" class="form-control" required name="NationalId"/>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="input-group input-group-outline my-3">
                                    <select class="form-control" required name="classId">
                                        <option disabled selected>Select Class</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="input-group input-group-static my-3">
                                    <label>Date of Birth</label>
                                    <input type="date" class="form-control" required name="BirthDate"/>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="input-group input-group-outline my-3">
                                    <label class="form-label">Parent Contact</label>
                                    <input type="tel" class="form-control" required name="ParentContact"/>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="input-group input-group-outline my-3">
                                    <label class="form-label">Address</label>
                                    <input type="text" class="form-control" required name="Address"/>
                                </div>
                            </div>
                        </div>
                        <div class="row">

                            <div class="col-12">
                                <div class="input-group input-group-outline my-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" required name="Email"/>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Add Student</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
}

@section Scripts {
    <script>
        // This script for taking attendance.
        const takeAttendanceButton = document.getElementById(
            "take-attendance-button"
        );
        const attendanceButtons = document.getElementById("attendance-buttons");
        const SaveAttendanceButton = document.getElementById(
            "save-attendance-button"
        );
        const addNoteButtons = document.getElementsByClassName("add-note-btn");
        const absenceCheckboxes =
            document.getElementsByClassName("absence-checkbox");
        takeAttendanceButton.addEventListener("click", () => {
            if (takeAttendanceButton.textContent.includes("Take Attendance")) {
                takeAttendanceButton.textContent = "Cancel";
            } else {
                takeAttendanceButton.innerText = "Take Attendance";
            }
            attendanceButtons.classList.toggle("btn-group");
            SaveAttendanceButton.classList.toggle("d-none");
            takeAttendanceButton.classList.toggle("btn-primary");
            takeAttendanceButton.classList.toggle("btn-secondary");
            takeAttendanceButton.classList.toggle("w-100");
            takeAttendanceButton.classList.toggle("w-50");

            for (let index = 0; index < absenceCheckboxes.length; index++) {
                absenceCheckboxes[index].classList.toggle("d-none");
                addNoteButtons[index].classList.toggle("d-none");
            }
        });
        function addStudentIdToNoteModel(studentId) {
            document.getElementById("addStudentNoteStudentId").value = studentId;
        }
    </script>

}